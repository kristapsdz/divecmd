.\"	$Id$
.\"
.\" Copyright (c) 2017 Kristaps Dzonsons <kristaps@bsd.lv>
.\"
.\" This library is free software; you can redistribute it and/or
.\" modify it under the terms of the GNU Lesser General Public
.\" License as published by the Free Software Foundation; either
.\" version 2.1 of the License, or (at your option) any later version.
.\" 
.\" This library is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
.\" Lesser General Public License for more details.
.\" 
.\" You should have received a copy of the GNU Lesser General Public
.\" License along with this library; if not, write to the Free Software
.\" Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
.\" MA 02110-1301 USA
.\" 
.Dd $Mdocdate: February 4 2017 $
.Dt DIVECMD2GRAP 1
.Os
.Sh NAME
.Nm divecmd2grap
.Nd graph dives with grap
.Sh SYNOPSIS
.Nm divecmd2grap
.Op Fl dv
.Op Fl m Ar mode
.Op Fl s Ar splitmode
.Op Ar files...
.Sh DESCRIPTION
The
.Nm
utility accepts XML files generated by
.Xr divecmd 1
and graphs each dive's depths in the
.Xr grap 1
data format.
By default, dives start at time zero through their maximum time.
Multiple dives are superimposed
.Pq Dq stacked .
Its arguments are as follows:
.Bl -tag -width Ds
.It Fl d
Derivatives.
Show change in velocity instead of depth.
Does not apply to
.Ar summary
or
.Ar scatter
modes.
.It Fl m Ar mode
Graphing mode.
May be one of the following:
.Pp
.Bl -tag -width Ds -compact
.It Ar aggr
Line graph connecting
.Pq Dq aggregating
subsequent dives with real time (relative to the beginning of the first
dive) on the x-axis and depth on the y-xais.
.It Ar rest
Impulse graph with each dive's rest time (surface interval) on the
positive y-axis and dive time on the negative y-axis.
The x-axis is independent.
.It Ar restscatter
Scatter graph with points corresponding to dive time and rest time.
A line with minimum suggested free diving interval is shown (twice the
dive time) if any of the dives are free dives.
.It Ar scatter
Scatter graph with points at the intersection of dives' maximum depth
and time.
.It Ar stack
Default line graph with dives layered over one other, dive time on the
x-axis, depth on the y-axis.
.It Ar summary
Each independent dive is shown on the x-axis with the maximum depth and
time above and below, respectively, on the y-axis.
.El
.It Fl s Ar splitmode
Split up
.Pq Dq group
dives according to a mode, which may be
.Ar none ,
for the default of no splitting (all in one group), and
.Ar date ,
which groups dives by date.
Dive groups are each shown in an individual colour.
All graphing modes respond intelligently to group splits.
.It Fl v
Parse files in verbose mode.
.It Ar files...
XML input files with one or more dives.
.El
.Pp
.Nm
exports to the data format accepted by
.Xr grap 1 .
A simple
.Xr grap 1
documented is also emitted with width 5 inches, height 3 inches.
.Sh EXIT STATUS
.Ex -std
.Sh EXAMPLES
This uses
.Xr groff 1
and sets the paper size to A5.
.Em Note :
the
.Xr grap 1 ,
.Xr pic 1 ,
and
.Xr groff 1
tools don't play nicely with landscape display.
.Bd -literal -offset indent
divecmd2grap -msummary dives.xml | \e
  groff -Gp -Tpdf -P-p5.8i,8.3i > foo.pdf
.Ed
.Pp
To compare free dive resting times across days:
.Bd -literal -offset indent
divecmd2grap -sdate -mrestscatter day1.xml day2 | \e
  groff -Gp -Tpdf -P-p5.8i,8.3i > foo.pdf
.Ed
.Sh SEE ALSO
.Xr divecmd 1 ,
.Xr grap 1 ,
.Xr groff 1
.Sh AUTHORS
The
.Nm
utility was written by
.An Kristaps Dzonsons ,
.Mt kristaps@bsd.lv .
.Sh CAVEATS
Initial tests show that
.Nm
doesn't play nicely with non-GNU troff.
